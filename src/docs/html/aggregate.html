<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Aggregate functions list &mdash; madIS 1.9 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/jsMath/easy/load.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="top" title="madIS 1.9 documentation" href="index.html" />
    <link rel="next" title="Vtable functions list" href="vtable.html" />
    <link rel="prev" title="Row functions list" href="row.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="vtable.html" title="Vtable functions list"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="row.html" title="Row functions list"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">madIS 1.9 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-functions.aggregate.__init__">
<span id="id1"></span><span id="aggregate-functions-list"></span><h1>Aggregate functions list<a class="headerlink" href="#module-functions.aggregate.__init__" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-functions.aggregate.date">
<span id="date-functions"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">date</span></tt> functions<a class="headerlink" href="#module-functions.aggregate.date" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><strong>avgdtdiff function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.date.avgdtdiff">
<tt class="descname">avgdtdiff</tt><big>(</big><em>date</em><big>)</big><a class="headerlink" href="#functions.aggregate.date.avgdtdiff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns the average difference <em>date</em> values of the group in milliseconds. Input dates should be in <a class="reference internal" href="#iso8601"><em>ISO 8601 format</em></a>.</p>
<p>Examples:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">&#39;2007-01-01 00:04:37&#39;</span>
<span class="gp">... </span><span class="s">&#39;2007-01-01 00:04:39&#39;</span>
<span class="gp">... </span><span class="s">&#39;2007-01-01 00:04:40&#39;</span>
<span class="gp">... </span><span class="s">&#39;2007-01-01 00:04:49&#39;</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select avgdtdiff(a) from table1&quot;</span><span class="p">)</span>
<span class="go">avgdtdiff(a)</span>
<span class="go">------------</span>
<span class="go">3000.0</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="docutils">
<dt><strong>dategroupduration function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.date.dategroupduration">
<tt class="descname">dategroupduration</tt><big>(</big><em>date</em><big>)</big><a class="headerlink" href="#functions.aggregate.date.dategroupduration" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns the duration of the group of dates in seconds. Input dates should be in <a class="reference internal" href="#iso8601"><em>ISO 8601 format</em></a>.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">&#39;2007-01-01 00:04:37&#39;</span>
<span class="gp">... </span><span class="s">&#39;2007-01-01 00:04:39&#39;</span>
<span class="gp">... </span><span class="s">&#39;2007-01-01 00:04:40&#39;</span>
<span class="gp">... </span><span class="s">&#39;2007-01-01 00:04:49&#39;</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select dategroupduration(a) from table1&quot;</span><span class="p">)</span>
<span class="go">dategroupduration(a)</span>
<span class="go">--------------------</span>
<span class="go">12</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select dategroupduration(a) from (select &#39;2005-01-01&#39; as a) &quot;</span><span class="p">)</span>
<span class="go">dategroupduration(a)</span>
<span class="go">--------------------</span>
<span class="go">0</span>
</pre></div>
</div>
</dd>
<dt><strong>frecencyindex function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.date.frecencyindex">
<tt class="descname">frecencyindex</tt><big>(</big><em>date</em><big>)</big><a class="headerlink" href="#functions.aggregate.date.frecencyindex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns the frecency Index which is computed based on a set of <em>date</em> values, using predifend time-windows.
Input dates should be in <a class="reference internal" href="#iso8601"><em>ISO 8601 format</em></a>.</p>
<p>Examples:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">&#39;2011-04-01 00:04:37&#39;</span>
<span class="gp">... </span><span class="s">&#39;2011-01-01 00:04:39&#39;</span>
<span class="gp">... </span><span class="s">&#39;2011-02-12 00:04:40&#39;</span>
<span class="gp">... </span><span class="s">&#39;2011-02-14 00:04:49&#39;</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select frecencyindex(a) from table1&quot;</span><span class="p">)</span>
<span class="go">frecencyindex(a)</span>
<span class="go">----------------</span>
<span class="go">2.9</span>
</pre></div>
</div>
</dd>
<dt><strong>mindtdiff function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.date.mindtdiff">
<tt class="descname">mindtdiff</tt><big>(</big><em>date</em><big>)</big><a class="headerlink" href="#functions.aggregate.date.mindtdiff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns the minimum difference <em>date</em> values of the group in milliseconds. Input dates should be in <a class="reference internal" href="#iso8601"><em>ISO 8601 format</em></a>.</p>
<p>Examples:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">&#39;2007-01-01 00:03:13&#39;</span>
<span class="gp">... </span><span class="s">&#39;2007-01-01 00:03:27&#39;</span>
<span class="gp">... </span><span class="s">&#39;2007-01-01 00:03:36&#39;</span>
<span class="gp">... </span><span class="s">&#39;2007-01-01 00:04:39&#39;</span>
<span class="gp">... </span><span class="s">&#39;2007-01-01 00:04:40&#39;</span>
<span class="gp">... </span><span class="s">&#39;2007-01-01 00:04:49&#39;</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select mindtdiff(a) from table1&quot;</span><span class="p">)</span>
<span class="go">mindtdiff(a)</span>
<span class="go">------------</span>
<span class="go">1000</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="module-functions.aggregate.graph">
<span id="graph-functions"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">graph</span></tt> functions<a class="headerlink" href="#module-functions.aggregate.graph" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><strong>graphcliques function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.graph.graphcliques">
<tt class="descname">graphcliques</tt><big>(</big><em>node1</em>, <em>node2</em><big>)</big> &rarr; graph cliques<a class="headerlink" href="#functions.aggregate.graph.graphcliques" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Finds and returns the cliques in the graph defined by the node1&lt;-&gt;node2 links.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">n1   n2</span>
<span class="gp">... </span><span class="s">n2   n3</span>
<span class="gp">... </span><span class="s">n1   n3</span>
<span class="gp">... </span><span class="s">n3   n4</span>
<span class="gp">... </span><span class="s">n4   n5</span>
<span class="gp">... </span><span class="s">n5   n3</span>
<span class="gp">... </span><span class="s">n1   n6</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select graphcliques(a,b) from table1&quot;</span><span class="p">)</span>  
<span class="go">cliqueid | nodeid</span>
<span class="go">-----------------</span>
<span class="go">0        | n1</span>
<span class="go">0        | n2</span>
<span class="go">0        | n3</span>
<span class="go">1        | n3</span>
<span class="go">1        | n4</span>
<span class="go">1        | n5</span>
</pre></div>
</div>
</dd>
<dt><strong>graphpowerhash function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.graph.graphpowerhash">
<tt class="descname">graphpowerhash</tt><big>(</big><em>steps</em>, <span class="optional">[</span><em>undirected_edge</em>, <span class="optional">]</span><em>node1</em>, <em>node2</em><span class="optional">[</span>, <em>node1_details</em>, <em>edge_details</em>, <em>node2_details</em><span class="optional">]</span><big>)</big> &rarr; jpack of graph node hashes<a class="headerlink" href="#functions.aggregate.graph.graphpowerhash" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Graph power hashing is based on a <a class="reference external" href="http://en.wikipedia.org/wiki/Power_iteration">power iteration algorithm</a>
that calculates hashes on every processing step. The produced output, contains for every node in the input graph
a hash that &#8220;describes&#8221; its &#8220;surroundings&#8221;.</p>
<p>Parameters:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">steps:</th><td class="field-body"><p class="first">The <em>steps</em> option controls the number of steps that the power hashing will be executed for. Another
way to conceptualize the <em>steps</em> parameter is to think of it as the radius of the graph around
a particular node that the node&#8217;s hash covers.</p>
<p>Steps parameter&#8217;s possible value are:</p>
<ul class="simple">
<li>null (default). When steps=null, then steps is automatically set to number_of_nodes/2</li>
<li>Positive integer value.</li>
<li>-1 . Steps is set to number_of_nodes</li>
<li>Negative integers, steps is set to number_of_nodes / absolute_value(steps)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">undirected_edge&#8217;:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first">This option can only have the <em>null</em> value.</p>
<ul class="simple">
<li>Parameter absent. The graph is assumed to be directed.</li>
<li>Parameter present and having a <em>null</em> value. The graph is assumed to be undirected</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">node1,node2:</th><td class="field-body"><p class="first">Node1 connects to Node2. If node1 doesn&#8217;t connect to any node, then <em>node2</em>&#8216;s value should be null.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">node and edge details:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first last">Optional details, that are processed with the graph&#8217;s structure. In essence these
parameters define &#8220;tags&#8221; on the nodes and edges of the graph.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The graph power hash algorithm is an experimental algorithm created by me, Lefteris Stamatogiannakis. I haven&#8217;t
proved its correctness, so please use it with care. Due to its hash usage, there is a (very low probability)
that two different graphs could hash to the same power hash.</p>
<p class="last">I would be very very thankfull to anyone knowledgable in graph theory, who could prove it to be wrong (or correct).
If the reader knows of a paper that describes another algorithm similar to this algorithm, i would be glad to be pointed towards it.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The computational complexity of the powerhash algorithm is O(n * steps * average_node_degree). The optimal value for
the hash to fully cover the graph, is to set the steps parameter to <em>graph_diameter</em> / 2.</p>
<p class="last">Right now for steps=null, we take the worse upper bound of n / 2, so the computational complexity becomes
O(n * ~(n/2) * average_node_degree).</p>
</div>
<p>Examples:</p>
<p>Directed graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1   2</span>
<span class="gp">... </span><span class="s">2   3</span>
<span class="gp">... </span><span class="s">3   4</span>
<span class="gp">... </span><span class="s">4   5</span>
<span class="gp">... </span><span class="s">5   3</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select graphpowerhash(null, a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">graphpowerhash(null, a,b)</span>
<span class="go">------------------------------------------------------------------------------------------------------------------------------</span>
<span class="go">[&quot;OaNj+OtIZPqcwjc3QVvKpg&quot;,&quot;Um7OU79ApcRNA2TKrdcBcA&quot;,&quot;ZyQT/AoKyjIkwWMNvceK2A&quot;,&quot;3vaHWSLU/H32HvHTVBkpUQ&quot;,&quot;+3uZjYUMSXwyZs7HFHKNVg&quot;]</span>
</pre></div>
</div>
<p>Above graph having its nodes renumbered (its powerhash is the same as above):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table2</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">2   5</span>
<span class="gp">... </span><span class="s">5   4</span>
<span class="gp">... </span><span class="s">4   1</span>
<span class="gp">... </span><span class="s">1   3</span>
<span class="gp">... </span><span class="s">3   4</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select graphpowerhash(null, a,b) from table2&quot;</span><span class="p">)</span>
<span class="go">graphpowerhash(null, a,b)</span>
<span class="go">------------------------------------------------------------------------------------------------------------------------------</span>
<span class="go">[&quot;OaNj+OtIZPqcwjc3QVvKpg&quot;,&quot;Um7OU79ApcRNA2TKrdcBcA&quot;,&quot;ZyQT/AoKyjIkwWMNvceK2A&quot;,&quot;3vaHWSLU/H32HvHTVBkpUQ&quot;,&quot;+3uZjYUMSXwyZs7HFHKNVg&quot;]</span>
</pre></div>
</div>
<p>Above graph with a small change (its hash differs from above graphs):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table3</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">2   5</span>
<span class="gp">... </span><span class="s">5   4</span>
<span class="gp">... </span><span class="s">4   1</span>
<span class="gp">... </span><span class="s">1   3</span>
<span class="gp">... </span><span class="s">3   5</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select graphpowerhash(null, a,b) from table3&quot;</span><span class="p">)</span>
<span class="go">graphpowerhash(null, a,b)</span>
<span class="go">------------------------------------------------------------------------------------------------------------------------------</span>
<span class="go">[&quot;APq1eISun1GpYjgUhiMrLA&quot;,&quot;NPPh9FLzC5cUedxldXV77Q&quot;,&quot;VVZ93zo6gePuMeRf6f00Zg&quot;,&quot;df/4yDABlitCTfOGut0NvA&quot;,&quot;lqo+lY4fcjqujlgsYr+3Yw&quot;]</span>
</pre></div>
</div>
<p>Actual testing of equality or inequality of above graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select hashmd5( (select graphpowerhash(null, a,b) from table1) )=hashmd5( (select graphpowerhash(null, a,b) from table2) ) as grapheq&quot;</span><span class="p">)</span>
<span class="go">grapheq</span>
<span class="go">-------</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select hashmd5( (select graphpowerhash(null, a,b) from table1) )=hashmd5( (select graphpowerhash(null, a,b) from table3) ) as grapheq&quot;</span><span class="p">)</span>
<span class="go">grapheq</span>
<span class="go">-------</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Graph with only one node:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select graphpowerhash(null, a, null) from (select * from table1 limit 1)&quot;</span><span class="p">)</span>
<span class="go">graphpowerhash(null, a, null)</span>
<span class="go">-----------------------------</span>
<span class="go">[&quot;TOiuilAk4RLkg01tIwyvcg&quot;]</span>
</pre></div>
</div>
<p>Undirected version of table1&#8217;s graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select graphpowerhash(null, null, a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">graphpowerhash(null, null, a,b)</span>
<span class="go">------------------------------------------------------------------------------------------------------------------------------</span>
<span class="go">[&quot;JudlYSkYV7rFHjk94abY/A&quot;,&quot;W88IN4kgDSeVX9kaY36SJg&quot;,&quot;W88IN4kgDSeVX9kaY36SJg&quot;,&quot;6ez9ee0N2ogdvKJVQ8VKWA&quot;,&quot;7gz+LT/LtsyFc+GxMUlL8g&quot;]</span>
</pre></div>
</div>
<p>Same graph as above, but some of the edges have been reversed (the undirected powerhash matches the powerhash above):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table4</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">2   1</span>
<span class="gp">... </span><span class="s">2   3</span>
<span class="gp">... </span><span class="s">3   4</span>
<span class="gp">... </span><span class="s">4   5</span>
<span class="gp">... </span><span class="s">3   5</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select graphpowerhash(null, null, a,b) from table4&quot;</span><span class="p">)</span>
<span class="go">graphpowerhash(null, null, a,b)</span>
<span class="go">------------------------------------------------------------------------------------------------------------------------------</span>
<span class="go">[&quot;JudlYSkYV7rFHjk94abY/A&quot;,&quot;W88IN4kgDSeVX9kaY36SJg&quot;,&quot;W88IN4kgDSeVX9kaY36SJg&quot;,&quot;6ez9ee0N2ogdvKJVQ8VKWA&quot;,&quot;7gz+LT/LtsyFc+GxMUlL8g&quot;]</span>
</pre></div>
</div>
<p>Graph similarity, using the step parameter (value of step defines the radius of the similar subgraphs that can be found):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jaccard( (select graphpowerhash(3, a, b) from table1), (select graphpowerhash(3, a, b) from table3) ) as jacsim&quot;</span><span class="p">)</span>
<span class="go">jacsim</span>
<span class="go">------</span>
<span class="go">0.0</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jaccard( (select graphpowerhash(1, a, b) from table1), (select graphpowerhash(1, a, b) from table3) ) as jacsim&quot;</span><span class="p">)</span>
<span class="go">jacsim</span>
<span class="go">------</span>
<span class="go">0.25</span>
</pre></div>
</div>
<p>Powerhash of graph having details (using a chemical composition):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table5</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1   2   O   =   C</span>
<span class="gp">... </span><span class="s">2   3   C   =   O</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>First without details:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select graphpowerhash(null, null, a, b) from table5&quot;</span><span class="p">)</span>
<span class="go">graphpowerhash(null, null, a, b)</span>
<span class="go">----------------------------------------------------------------------------</span>
<span class="go">[&quot;Rw3sDN24TI7YARBNOOmYSg&quot;,&quot;9m5wcZf9iUxDwgzQkzu6Ag&quot;,&quot;9m5wcZf9iUxDwgzQkzu6Ag&quot;]</span>
</pre></div>
</div>
<p>Second with all details:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select graphpowerhash(null, null, a, b, c, d, e) from table5&quot;</span><span class="p">)</span>
<span class="go">graphpowerhash(null, null, a, b, c, d, e)</span>
<span class="go">----------------------------------------------------------------------------</span>
<span class="go">[&quot;CPebw+eZYzw5bWgx47/tkg&quot;,&quot;CPebw+eZYzw5bWgx47/tkg&quot;,&quot;WNn4aDDBKcoMMi+nrz5JEA&quot;]</span>
</pre></div>
</div>
</dd>
<dt><strong>graphtodot function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.graph.graphtodot">
<tt class="descname">graphtodot</tt><big>(</big><em>graphname</em>, <span class="optional">[</span><em>undirected_edge</em>, <span class="optional">]</span><em>node1</em>, <em>node2</em><span class="optional">[</span>, <em>node1_details</em>, <em>edge_details</em>, <em>node2_details</em><span class="optional">]</span><big>)</big> &rarr; graphviz dot graph<a class="headerlink" href="#functions.aggregate.graph.graphtodot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns the <em>Graphviz</em> DOT representation of the input graph.</p>
<p>Examples:</p>
<p>Directed graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1   2</span>
<span class="gp">... </span><span class="s">2   3</span>
<span class="gp">... </span><span class="s">3   4</span>
<span class="gp">... </span><span class="s">4   5</span>
<span class="gp">... </span><span class="s">5   3</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select graphtodot(null, a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">graphtodot(null, a,b)</span>
<span class="go">------------------------------------------------------------------------</span>
<span class="go">digraph  {</span>
<span class="go">&quot;1&quot; -&gt; &quot;2&quot;;</span>
<span class="go">&quot;2&quot; -&gt; &quot;3&quot;;</span>
<span class="go">&quot;3&quot; -&gt; &quot;4&quot;;</span>
<span class="go">&quot;4&quot; -&gt; &quot;5&quot;;</span>
<span class="go">&quot;5&quot; -&gt; &quot;3&quot;;</span>
<span class="go">}</span>
</pre></div>
</div>
<p>Undirected graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table2</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">2   5</span>
<span class="gp">... </span><span class="s">5   4</span>
<span class="gp">... </span><span class="s">4   1</span>
<span class="gp">... </span><span class="s">1   3</span>
<span class="gp">... </span><span class="s">3   4</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select graphtodot(null, null, a,b) from table2&quot;</span><span class="p">)</span>
<span class="go">graphtodot(null, null, a,b)</span>
<span class="go">----------------------------------------------------------------------</span>
<span class="go">graph  {</span>
<span class="go">&quot;1&quot; -- &quot;3&quot;;</span>
<span class="go">&quot;2&quot; -- &quot;5&quot;;</span>
<span class="go">&quot;3&quot; -- &quot;4&quot;;</span>
<span class="go">&quot;4&quot; -- &quot;1&quot;;</span>
<span class="go">&quot;5&quot; -- &quot;4&quot;;</span>
<span class="go">}</span>
</pre></div>
</div>
<p>Graph with details:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table5</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1   2   O   =   C</span>
<span class="gp">... </span><span class="s">2   3   C   =   O</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select graphtodot(&#39;chem_comp_1&#39;, null, a, b, c, d, e) from table5&quot;</span><span class="p">)</span>
<span class="go">graphtodot(&#39;chem_comp_1&#39;, null, a, b, c, d, e)</span>
<span class="go">------------------------------------------------------------------------------------------------------------------------</span>
<span class="go">graph chem_comp_1 {</span>
<span class="go">&quot;1&quot; [label=&quot;O&quot;];</span>
<span class="go">&quot;1&quot; -- &quot;2&quot; [label=&quot;=&quot;];</span>
<span class="go">&quot;2&quot; [label=&quot;C&quot;];</span>
<span class="go">&quot;2&quot; -- &quot;3&quot; [label=&quot;=&quot;];</span>
<span class="go">&quot;3&quot; [label=&quot;O&quot;];</span>
<span class="go">}</span>
</pre></div>
</div>
</dd>
<dt><strong>graphtotgf function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.graph.graphtotgf">
<tt class="descname">graphtotgf</tt><big>(</big><em>node1</em>, <em>node2</em><span class="optional">[</span>, <em>node1_details</em>, <em>edge_details</em>, <em>node2_details</em><span class="optional">]</span><big>)</big> &rarr; TGF graph<a class="headerlink" href="#functions.aggregate.graph.graphtotgf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns the TGF representation of the input graph.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1   2</span>
<span class="gp">... </span><span class="s">2   3</span>
<span class="gp">... </span><span class="s">3   4</span>
<span class="gp">... </span><span class="s">4   5</span>
<span class="gp">... </span><span class="s">5   3</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select graphtotgf(a,b) from table1&quot;</span><span class="p">)</span>  
<span class="go">graphtotgf(a,b)</span>
<span class="go">------------------------------------------</span>
<span class="go">1</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="go">4</span>
<span class="go">5</span>
<span class="go">#</span>
<span class="go">1 2</span>
<span class="go">2 3</span>
<span class="go">3 4</span>
<span class="go">4 5</span>
<span class="go">5 3</span>
</pre></div>
</div>
<p>Graph with details:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table5</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1   2   O   =   C</span>
<span class="gp">... </span><span class="s">2   3   C   =   O</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select graphtotgf(a, b, c, d, e) from table5&quot;</span><span class="p">)</span>
<span class="go">graphtotgf(a, b, c, d, e)</span>
<span class="go">--------------------------</span>
<span class="go">1 O</span>
<span class="go">2 C</span>
<span class="go">3 O</span>
<span class="go">#</span>
<span class="go">1 2 =</span>
<span class="go">2 3 =</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="module-functions.aggregate.jpacks">
<span id="jpacks-functions"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">jpacks</span></tt> functions<a class="headerlink" href="#module-functions.aggregate.jpacks" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><strong>jdictgroup function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.jpacks.jdictgroup">
<tt class="descname">jdictgroup</tt><big>(</big><em>columns</em><big>)</big><a class="headerlink" href="#functions.aggregate.jpacks.jdictgroup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Groups columns of a group into a jdict.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">word1   1</span>
<span class="gp">... </span><span class="s">word2   1</span>
<span class="gp">... </span><span class="s">word3   2</span>
<span class="gp">... </span><span class="s">word4   2</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jdictgroup(a) from table1 group by b&quot;</span><span class="p">)</span>
<span class="go">jdictgroup(a)</span>
<span class="go">---------------------------</span>
<span class="go">{&quot;word1&quot;:null,&quot;word2&quot;:null}</span>
<span class="go">{&quot;word3&quot;:null,&quot;word4&quot;:null}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jdictgroup(a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">jdictgroup(a,b)</span>
<span class="go">-----------------------------------------</span>
<span class="go">{&quot;word1&quot;:1,&quot;word2&quot;:1,&quot;word3&quot;:2,&quot;word4&quot;:2}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table2</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">[1,2]   1</span>
<span class="gp">... </span><span class="s">[3,4]   1</span>
<span class="gp">... </span><span class="s">[5,6]   2</span>
<span class="gp">... </span><span class="s">[7,8]   2</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jdictgroup(a) from table2&quot;</span><span class="p">)</span>
<span class="go">jdictgroup(a)</span>
<span class="go">-----------------------------------------------------</span>
<span class="go">{&quot;[1,2]&quot;:null,&quot;[3,4]&quot;:null,&quot;[5,6]&quot;:null,&quot;[7,8]&quot;:null}</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jdictgroup(a,b) from table2&quot;</span><span class="p">)</span>
<span class="go">jdictgroup(a,b)</span>
<span class="go">-----------------------------------------</span>
<span class="go">{&quot;[1,2]&quot;:1,&quot;[3,4]&quot;:1,&quot;[5,6]&quot;:2,&quot;[7,8]&quot;:2}</span>
</pre></div>
</div>
</dd>
<dt><strong>jdictgroupunion function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.jpacks.jgroupunion">
<tt class="descname">jgroupunion</tt><big>(</big><em>jdicts</em><big>)</big> &rarr; jdict<a class="headerlink" href="#functions.aggregate.jpacks.jgroupunion" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Calculates the union of all jdicts inside a group. The returned jdict&#8217;s key values, are
calculated as the max length of the lists (or dictionaries) that have been found inside
the individual jdicts of the group.</p>
<p>Example:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">&#39;{&quot;b&quot;:1, &quot;a&quot;:1}&#39;</span>
<span class="gp">... </span><span class="s">&#39;{&quot;c&quot;:1, &quot;d&quot;:[1,2,3]}&#39;</span>
<span class="gp">... </span><span class="s">&#39;{&quot;b&quot;:{&quot;1&quot;:2,&quot;3&quot;:4}, &quot;d&quot;:1}&#39;</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jdictgroupunion(a) from table1&quot;</span><span class="p">)</span>
<span class="go">jdictgroupunion(a)</span>
<span class="go">-------------------------</span>
<span class="go">{&quot;b&quot;:2,&quot;a&quot;:1,&quot;c&quot;:1,&quot;d&quot;:3}</span>
</pre></div>
</div>
</dd>
<dt><strong>jgroup function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.jpacks.jgroup">
<tt class="descname">jgroup</tt><big>(</big><em>columns</em><big>)</big><a class="headerlink" href="#functions.aggregate.jpacks.jgroup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Groups columns of a group into a jpack.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">word1   1</span>
<span class="gp">... </span><span class="s">word2   1</span>
<span class="gp">... </span><span class="s">word3   2</span>
<span class="gp">... </span><span class="s">word4   2</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jgroup(a) from table1 group by b&quot;</span><span class="p">)</span>
<span class="go">jgroup(a)</span>
<span class="go">-----------------</span>
<span class="go">[&quot;word1&quot;,&quot;word2&quot;]</span>
<span class="go">[&quot;word3&quot;,&quot;word4&quot;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jgroup(a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">jgroup(a,b)</span>
<span class="go">-------------------------------------------------</span>
<span class="go">[[&quot;word1&quot;,1],[&quot;word2&quot;,1],[&quot;word3&quot;,2],[&quot;word4&quot;,2]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table2</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">[1,2]   1</span>
<span class="gp">... </span><span class="s">[3,4]   1</span>
<span class="gp">... </span><span class="s">[5,6]   2</span>
<span class="gp">... </span><span class="s">[7,8]   2</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jgroup(a) from table2&quot;</span><span class="p">)</span>
<span class="go">jgroup(a)</span>
<span class="go">-------------------------</span>
<span class="go">[[1,2],[3,4],[5,6],[7,8]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jgroup(a,b) from table2&quot;</span><span class="p">)</span>
<span class="go">jgroup(a,b)</span>
<span class="go">-----------------------------------------</span>
<span class="go">[[[1,2],1],[[3,4],1],[[5,6],2],[[7,8],2]]</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jgroup(jdict(&#39;a&#39;,a,&#39;b&#39;,b)) from table2&quot;</span><span class="p">)</span>
<span class="go">jgroup(jdict(&#39;a&#39;,a,&#39;b&#39;,b))</span>
<span class="go">-------------------------------------------------------------------------</span>
<span class="go">[{&quot;a&quot;:[1,2],&quot;b&quot;:1},{&quot;a&quot;:[3,4],&quot;b&quot;:1},{&quot;a&quot;:[5,6],&quot;b&quot;:2},{&quot;a&quot;:[7,8],&quot;b&quot;:2}]</span>
</pre></div>
</div>
</dd>
<dt><strong>jgroupintersection function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.jpacks.jgroupintersection">
<tt class="descname">jgroupintersection</tt><big>(</big><em>columns</em><big>)</big> &rarr; jpack<a class="headerlink" href="#functions.aggregate.jpacks.jgroupintersection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Calculates the intersection of all jpacks (by treating them as sets) inside a group.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">&#39;[1,2]&#39; 2</span>
<span class="gp">... </span><span class="s">&#39;[2,3]&#39; 2</span>
<span class="gp">... </span><span class="s">&#39;[2,4]&#39; &#39;[2,11]&#39;</span>
<span class="gp">... </span><span class="s">2 2</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jgroupintersection(a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">jgroupintersection(a,b)</span>
<span class="go">-----------------------</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jgroupintersection(1)&quot;</span><span class="p">)</span>
<span class="go">jgroupintersection(1)</span>
<span class="go">---------------------</span>
<span class="go">1</span>
</pre></div>
</div>
</dd>
<dt><strong>jgroupunion function</strong></dt>
<dd><dl class="first function">
<dt>
<tt class="descname">jgroupunion</tt><big>(</big><em>columns</em><big>)</big> &rarr; jpack</dt>
<dd></dd></dl>

<p>Calculates the union of the jpacks (by treating them as sets) inside a group.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">&#39;[1,2]&#39; 6</span>
<span class="gp">... </span><span class="s">&#39;[2,3]&#39; 7</span>
<span class="gp">... </span><span class="s">&#39;[2,4]&#39; &#39;[8,11]&#39;</span>
<span class="gp">... </span><span class="s">5 9</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jgroupunion(a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">jgroupunion(a,b)</span>
<span class="go">----------------------</span>
<span class="go">[1,2,6,3,7,4,8,11,5,9]</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jgroupunion(1)&quot;</span><span class="p">)</span>
<span class="go">jgroupunion(1)</span>
<span class="go">--------------</span>
<span class="go">1</span>
</pre></div>
</div>
</dd>
<dt><strong>jgroupunionkeys function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.jpacks.jgroupunionkeys">
<tt class="descname">jgroupunionkeys</tt><big>(</big><em>columns</em><big>)</big> &rarr; jpack<a class="headerlink" href="#functions.aggregate.jpacks.jgroupunionkeys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Calculates the union of the jdict keys. Use it with care, because for performance
reasons the input data are not checked at all. They should all be jdicts.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">&#39;{&quot;1&quot;:1, &quot;2&quot;:3}&#39; &#39;{&quot;a&quot;:5}&#39;</span>
<span class="gp">... </span><span class="s">&#39;{&quot;2&quot;:1, &quot;3&quot;:3}&#39; &#39;{}&#39;</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jgroupunionkeys(a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">jgroupunionkeys(a,b)</span>
<span class="go">--------------------</span>
<span class="go">[&quot;1&quot;,&quot;2&quot;,&quot;a&quot;,&quot;3&quot;]</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jgroupunionkeys(&#39;{}&#39;)&quot;</span><span class="p">)</span>
<span class="go">jgroupunionkeys(&#39;{}&#39;)</span>
<span class="go">---------------------</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd>
<dt><strong>jgroupuniquelimit function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.jpacks.jgroupuniquelimit">
<tt class="descname">jgroupuniquelimit</tt><big>(</big><em>jpack</em>, <em>k</em>, <em>limit</em><big>)</big> &rarr; jpack<a class="headerlink" href="#functions.aggregate.jpacks.jgroupuniquelimit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns the k where the unique values inside all jpacks have reached limit.</p>
<p>Example:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">&#39;[1,2]&#39; 1</span>
<span class="gp">... </span><span class="s">&#39;[2,3,4,5]&#39; 2</span>
<span class="gp">... </span><span class="s">&#39;[2,4]&#39; 3</span>
<span class="gp">... </span><span class="s">5 4</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select jgroupuniquelimit(a,b,3) from table1&quot;</span><span class="p">)</span>
<span class="go">jgroupuniquelimit(a,b,3)</span>
<span class="go">------------------------</span>
<span class="go">2</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="module-functions.aggregate.mining">
<span id="mining-functions"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">mining</span></tt> functions<a class="headerlink" href="#module-functions.aggregate.mining" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><strong>freqitemsets function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.mining.freqitemsets">
<tt class="descname">freqitemsets</tt><big>(</big><em>datacol</em><span class="optional">[</span>, <em>threshold</em>, <em>noautothres</em>, <em>stats</em>, <em>maxlen</em><span class="optional">]</span><big>)</big> &rarr; [itemset_id:int, itemset_length:int, itemset_frequency:int, item:text]<a class="headerlink" href="#functions.aggregate.mining.freqitemsets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Calculates frequent itemsets on a given column (datacol). The algorithm is tuned for the
case when we have many different items (in the order of millions), many input itemsets, but
small itemset length (10-20).</p>
<p>Returned table schema:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">itemset_id:</th><td class="field-body">Automatic itemset id</td>
</tr>
<tr class="field-even field"><th class="field-name">itemset_length:</th><td class="field-body">Length of itemset</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">itemset_frequency:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">How many times an itemset has been found</td>
</tr>
<tr class="field-even field"><th class="field-name">item:</th><td class="field-body">Itemset&#8217;s item value</td>
</tr>
</tbody>
</table>
<p>Parameters:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">datacol:</th><td class="field-body"><p class="first">Column on which to calculate frequent itemsets</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">threshold:</th><td class="field-body"><p class="first">Default is 2</p>
<p>How many times an freq. itemset must appear for it to appear in the results</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">noautothres:</th><td class="field-body"><p class="first">1/0 (Default is 0)</p>
<p>Do not calculate the threshold automatically</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">stats:</th><td class="field-body"><p class="first">1/0 (Default is 0)</p>
<p>Return frequent itemset statistics</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">maxlen:</th><td class="field-body"><p class="first">NUMBER (Default is no limit at all)</p>
<p class="last">Maximum itemset length to search</p>
</td>
</tr>
</tbody>
</table>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">&#39;car wood bike&#39; &#39;first group&#39;</span>
<span class="gp">... </span><span class="s">&#39;car car wood&#39;  &#39;first group&#39;</span>
<span class="gp">... </span><span class="s">&#39;car wood&#39;      &#39;first group&#39;</span>
<span class="gp">... </span><span class="s">&#39;car wood ice&#39;  &#39;first group&#39;</span>
<span class="gp">... </span><span class="s">&#39;ice&#39;           &#39;second group&#39;</span>
<span class="gp">... </span><span class="s">&#39;car ice&#39;       &#39;second group&#39;</span>
<span class="gp">... </span><span class="s">&#39;car cream toy&#39; &#39;second group&#39;</span>
<span class="gp">... </span><span class="s">&#39;icecream ice car toy&#39;  &#39;second group&#39;</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select b,freqitemsets(a, &#39;threshold:2&#39;, &#39;noautothres:1&#39;, &#39;maxlen:2&#39;) from table1 group by b&quot;</span><span class="p">)</span>
<span class="go">b            | itemset_id | itemset_length | itemset_frequency | item</span>
<span class="go">---------------------------------------------------------------------</span>
<span class="go">first group  | 1          | 1              | 4                 | wood</span>
<span class="go">first group  | 2          | 1              | 4                 | car</span>
<span class="go">first group  | 3          | 2              | 4                 | car</span>
<span class="go">first group  | 3          | 2              | 4                 | wood</span>
<span class="go">second group | 1          | 1              | 3                 | ice</span>
<span class="go">second group | 2          | 1              | 3                 | car</span>
<span class="go">second group | 3          | 1              | 2                 | toy</span>
<span class="go">second group | 4          | 2              | 2                 | car</span>
<span class="go">second group | 4          | 2              | 2                 | ice</span>
<span class="go">second group | 5          | 2              | 2                 | car</span>
<span class="go">second group | 5          | 2              | 2                 | toy</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select b,freqitemsets(a, &#39;stats:1&#39;) from table1 group by b&quot;</span><span class="p">)</span>
<span class="go">b            | MaxTransactionLength | CombinationCount | PassedTransactions | ValidKeywords</span>
<span class="go">-------------------------------------------------------------------------------------------</span>
<span class="go">first group  | 3                    | 2                | 3                  | 2</span>
<span class="go">first group  | 3                    | 1                | 1                  | 2</span>
<span class="go">first group  | 3                    | 0                | 0                  | 0</span>
<span class="go">second group | 4                    | 3                | 3                  | 3</span>
<span class="go">second group | 4                    | 0                | 3                  | 0</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>sampledistvals function</strong></p>
<blockquote>
<div><dl class="function">
<dt id="functions.aggregate.mining.sampledistvals">
<tt class="descname">sampledistvals</tt><big>(</big><em>sample_size</em>, <em>C1</em>, <em>C2</em>, <em>C3</em><big>)</big> &rarr; [C1, C2, C3]<a class="headerlink" href="#functions.aggregate.mining.sampledistvals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Sampledistvals returns sample_size distinct values for each of the input C1..Cn columns.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">test1 2 3</span>
<span class="gp">... </span><span class="s">test1 2 3</span>
<span class="gp">... </span><span class="s">test2 4 2</span>
<span class="gp">... </span><span class="s">test4 2 t</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select sampledistvals(3, a, b, c) from table1&quot;</span><span class="p">)</span>
<span class="go">C1                        | C2    | C3</span>
<span class="go">---------------------------------------------</span>
<span class="go">[&quot;test1&quot;,&quot;test2&quot;,&quot;test4&quot;] | [2,4] | [2,3,&quot;t&quot;]</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>samplegroup function</strong></p>
<blockquote>
<div><dl class="function">
<dt id="functions.aggregate.mining.samplegroup">
<tt class="descname">samplegroup</tt><big>(</big><em>sample_size</em>, <em>C1</em>, <em>C2</em>, <em>C3</em><big>)</big><a class="headerlink" href="#functions.aggregate.mining.samplegroup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns a random sample_size set of rows.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">test1 2 3</span>
<span class="gp">... </span><span class="s">test1 2 3</span>
<span class="gp">... </span><span class="s">test2 4 2</span>
<span class="gp">... </span><span class="s">test4 2 t</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select samplegroup(2, a, b, c) from table1&quot;</span><span class="p">)</span> 
<span class="go">C1    | C2 | C3</span>
<span class="go">---------------</span>
<span class="gp">...</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select samplegroup(2) from (select 5 where 5=6)&quot;</span><span class="p">)</span> 
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="module-functions.aggregate.partialsort">
<span id="partialsort-functions"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">partialsort</span></tt> functions<a class="headerlink" href="#module-functions.aggregate.partialsort" title="Permalink to this headline">¶</a></h2>
<p><strong>partialsort function</strong></p>
<blockquote>
<div><dl class="function">
<dt id="functions.aggregate.partialsort.partialsort">
<tt class="descname">partialsort</tt><big>(</big><em>n</em>, <em>col1</em>, <em>col2</em>, <em>col3</em>, <em>....</em><big>)</big><a class="headerlink" href="#functions.aggregate.partialsort.partialsort" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>sorts the first n columns of its input</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Returned multiset schema:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">Columns are automatically named as col1, col2 ...</td>
</tr>
</tbody>
</table>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">aa  43</span>
<span class="gp">... </span><span class="s">ac  34</span>
<span class="gp">... </span><span class="s">ab  21</span>
<span class="gp">... </span><span class="s">as  23</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select partialsort(1,a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">c1 | c2</span>
<span class="go">-------</span>
<span class="go">aa | 43</span>
<span class="go">ab | 21</span>
<span class="go">ac | 34</span>
<span class="go">as | 23</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="module-functions.aggregate.selection">
<span id="selection-functions"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">selection</span></tt> functions<a class="headerlink" href="#module-functions.aggregate.selection" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><strong>groupdiff function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.selection.groupdiff">
<tt class="descname">groupdiff</tt><big>(</big><em>compare</em>, <em>values</em><big>)</big><a class="headerlink" href="#functions.aggregate.selection.groupdiff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Compares group members over the first argument (i.e. <em>compare</em>). It keeps only the rows where <em>compare</em> changes.
It appends a column at the end containing how many times <em>compare</em> repeats.</p>
<p>Examples:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">0  a</span>
<span class="gp">... </span><span class="s">0  b</span>
<span class="gp">... </span><span class="s">1  c</span>
<span class="gp">... </span><span class="s">1  d</span>
<span class="gp">... </span><span class="s">2  e</span>
<span class="gp">... </span><span class="s">3  e</span>
<span class="gp">... </span><span class="s">3  f</span>
<span class="gp">... </span><span class="s">3  g</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select groupdiff(a,b) as b from table1&quot;</span><span class="p">)</span>
<span class="go">b1 | b2 | b3</span>
<span class="go">------------</span>
<span class="go">0  | a  | 2</span>
<span class="go">1  | c  | 2</span>
<span class="go">2  | e  | 1</span>
<span class="go">3  | e  | 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select groupdiff(a) as a from table1&quot;</span><span class="p">)</span>
<span class="go">a1 | a2</span>
<span class="go">-------</span>
<span class="go">0  | 2</span>
<span class="go">1  | 2</span>
<span class="go">2  | 1</span>
<span class="go">3  | 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select groupdiff(b,a) as a from table1&quot;</span><span class="p">)</span>
<span class="go">a1 | a2 | a3</span>
<span class="go">------------</span>
<span class="go">a  | 0  | 1</span>
<span class="go">b  | 0  | 1</span>
<span class="go">c  | 1  | 1</span>
<span class="go">d  | 1  | 1</span>
<span class="go">e  | 2  | 2</span>
<span class="go">f  | 3  | 1</span>
<span class="go">g  | 3  | 1</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>imax function</strong></p>
<blockquote>
<div><dl class="function">
<dt id="functions.aggregate.selection.imax">
<tt class="descname">imax</tt><big>(</big><em>i</em>, <em>value</em><big>)</big><a class="headerlink" href="#functions.aggregate.selection.imax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns the i-th max value of the group.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">34  la</span>
<span class="gp">... </span><span class="s">18   lo</span>
<span class="gp">... </span><span class="s">120.0  all</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select imax(1,a) as first from table1&quot;</span><span class="p">)</span>
<span class="go">first</span>
<span class="go">-----</span>
<span class="go">120</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select imax(3,a) as third from table1&quot;</span><span class="p">)</span>
<span class="go">third</span>
<span class="go">-----</span>
<span class="go">18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select imax(2,cast( a as text))  as secstr from table1&quot;</span><span class="p">)</span>
<span class="go">secstr</span>
<span class="go">------</span>
<span class="go">18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select imax(4,a) from table1&quot;</span><span class="p">)</span>
<span class="go">imax(4,a)</span>
<span class="go">---------</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select imax(4,a) from (select 5 as a where a!=5)&quot;</span><span class="p">)</span>
<span class="go">imax(4,a)</span>
<span class="go">---------</span>
<span class="go">None</span>
</pre></div>
</div>
</div></blockquote>
<dl class="docutils">
<dt><strong>maxrow function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.selection.maxrow">
<tt class="descname">maxrow</tt><big>(</big><em>compare</em>, <em>value</em><big>)</big><a class="headerlink" href="#functions.aggregate.selection.maxrow" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Compares group members over the first argument (i.e. <em>compare</em>).
When the maximum is located, it returns the corresponding value in the second argument (i.e. <em>value</em>).</p>
<p>Examples:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">34  la</span>
<span class="gp">... </span><span class="s">18   lo</span>
<span class="gp">... </span><span class="s">120.0  all</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select maxrow(a,b) as b from table1&quot;</span><span class="p">)</span>
<span class="go">b</span>
<span class="go">---</span>
<span class="go">all</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select maxrow(a,a) as a from table1&quot;</span><span class="p">)</span>
<span class="go">a</span>
<span class="go">---</span>
<span class="go">120</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select maxrow(b,a) as a from table1&quot;</span><span class="p">)</span>
<span class="go">a</span>
<span class="go">--</span>
<span class="go">18</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>minrow function</strong></p>
<blockquote>
<div><dl class="function">
<dt id="functions.aggregate.selection.minrow">
<tt class="descname">minrow</tt><big>(</big><em>compare</em>, <em>value</em><big>)</big><a class="headerlink" href="#functions.aggregate.selection.minrow" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Compares group members over the first argument (i.e. <em>compare</em>).
When the minimum is located, it returns the corresponding value in the second argument (i.e. <em>value</em>).</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">34  la</span>
<span class="gp">... </span><span class="s">18   lo</span>
<span class="gp">... </span><span class="s">120.0  all</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select minrow(a,b) as b from table1&quot;</span><span class="p">)</span>
<span class="go">b</span>
<span class="go">--</span>
<span class="go">lo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select minrow(a,a) as a from table1&quot;</span><span class="p">)</span>
<span class="go">a</span>
<span class="go">--</span>
<span class="go">18</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select minrow(a,a) as a from (select 5 as a where a!=5)&quot;</span><span class="p">)</span>
<span class="go">a</span>
<span class="go">----</span>
<span class="go">None</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>ontop function</strong></p>
<blockquote>
<div><dl class="function">
<dt id="functions.aggregate.selection.ontop">
<tt class="descname">ontop</tt><big>(</big><em>n</em>, <em>compare</em>, <em>value1</em>, <em>value2</em>, <em>....</em><big>)</big> &rarr; [colname1, colname2 ...]<a class="headerlink" href="#functions.aggregate.selection.ontop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Compares group members over the second argument (i.e. <em>compare</em>), so as to locate the top <em>n</em> members
(specified in the first argument) and then returns the corresponding data under the specified columns
<em>value1, value2, ....</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Returned multiset schema:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">Columns are automatically named as <em>colname1 text, colname2 text...</em></td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="manual.html#tutmultiset"><em>Multisets</em></a> functions</li>
</ul>
</div>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">34  la</span>
<span class="gp">... </span><span class="s">18   lo</span>
<span class="gp">... </span><span class="s">120.0  all</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select ontop(1,a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">top1</span>
<span class="go">----</span>
<span class="go">all</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select ontop(2,a,a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">top1 | top2</span>
<span class="go">-----------</span>
<span class="go">120  | all</span>
<span class="go">34   | la</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select ontop(2,a,a,b,a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">top1 | top2 | top3 | top4</span>
<span class="go">-------------------------</span>
<span class="go">120  | all  | 120  | all</span>
<span class="go">34   | la   | 34   | la</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select ontop(pk) from (select 5 as pk where pk!=5)&quot;</span><span class="p">)</span>
<span class="go">top1</span>
<span class="go">-</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="module-functions.aggregate.statistics">
<span id="statistics-functions"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">statistics</span></tt> functions<a class="headerlink" href="#module-functions.aggregate.statistics" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><strong>amean function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.statistics.amean">
<tt class="descname">amean</tt><big>(</big><em>X</em><big>)</big> &rarr; [amean float]<a class="headerlink" href="#functions.aggregate.statistics.amean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes the arithmetic mean, i.e. the average, thus providing an alternative choise
to traditional <em>avg</em> offered by sqlite.</p>
<p>Examples:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1</span>
<span class="gp">... </span><span class="s">2</span>
<span class="gp">... </span><span class="s">2</span>
<span class="gp">... </span><span class="s">3</span>
<span class="gp">... </span><span class="s">&#39;text is ignored, as well as null values&#39;</span>
<span class="gp">... </span><span class="s">&#39;none&#39;</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select amean(a) from table1&quot;</span><span class="p">)</span>
<span class="go">amean(a)</span>
<span class="go">--------</span>
<span class="go">2.0</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="docutils">
<dt><strong>frecency function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.statistics.frecency">
<tt class="descname">frecency</tt><big>(</big><em>actiondate</em><span class="optional">[</span>, <em>points</em><span class="optional">[</span>, <em>now:date</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#functions.aggregate.statistics.frecency" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns a float weighted sum assigning to each action <em>points</em> or less, depending on the <em>actiondate</em> distance to the current date (or <em>now:date</em>).
In detail the action points decrease 30% at distance 10-30 days, 50% at  1-3 months, 70% at 3-6 months and 90% at greater distance. Date parameters should be in ISO8601 format.</p>
<blockquote id="iso8601">
<div><strong>ISO 8601 format</strong> :</div></blockquote>
<dl class="docutils">
<dt>Year:</dt>
<dd>YYYY (eg 1997)</dd>
<dt>Year and month:</dt>
<dd>YYYY-MM (eg 1997-07)</dd>
<dt>Complete date:</dt>
<dd>YYYY-MM-DD (eg 1997-07-16)</dd>
<dt>Complete date plus hours and minutes:</dt>
<dd>YYYY-MM-DD hh:mmTZD (eg 1997-07-16 19:20+01:00)</dd>
<dt>Complete date plus hours, minutes and seconds:</dt>
<dd>YYYY-MM-DD hh:mm:ssTZD (eg 1997-07-16 19:20:30+01:00)</dd>
<dt>Complete date plus hours and minutes:</dt>
<dd>YYYY-MM-DDThh:mmTZD (eg 1997-07-16T19:20+01:00)</dd>
<dt>Complete date plus hours, minutes and seconds:</dt>
<dd>YYYY-MM-DDThh:mm:ssTZD (eg 1997-07-16T19:20:30+01:00)</dd>
</dl>
<p>Examples:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">2009-06-01      1</span>
<span class="gp">... </span><span class="s">2009-08-28      2</span>
<span class="gp">... </span><span class="s">2009-09-17      3</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select frecency(a,&#39;now:2009-09-26 04:38:30&#39;) from table1&quot;</span><span class="p">)</span>
<span class="go">frecency(a,&#39;now:2009-09-26 04:38:30&#39;)</span>
<span class="go">-------------------------------------</span>
<span class="go">200.0</span>
</pre></div>
</div>
</dd>
<dt><strong>fsum function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.statistics.fsum">
<tt class="descname">fsum</tt><big>(</big><em>X</em><big>)</big> &rarr; json<a class="headerlink" href="#functions.aggregate.statistics.fsum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes the sum using fractional computation. It return the result in json format</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1</span>
<span class="gp">... </span><span class="s">2</span>
<span class="gp">... </span><span class="s">2</span>
<span class="gp">... </span><span class="s">10</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select fsum(a) from table1&quot;</span><span class="p">)</span>
<span class="go">fsum(a)</span>
<span class="go">-------</span>
<span class="go">[15, 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">0.99999999</span>
<span class="gp">... </span><span class="s">3.99999999</span>
<span class="gp">... </span><span class="s">0.78978989</span>
<span class="gp">... </span><span class="s">1.99999999</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select fsum(a) from table1&quot;</span><span class="p">)</span>
<span class="go">fsum(a)</span>
<span class="go">-------------------------------------</span>
<span class="go">[70164189421580937, 9007199254740992]</span>
</pre></div>
</div>
</dd>
<dt><strong>gmean function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.statistics.gmean">
<tt class="descname">gmean</tt><big>(</big><em>X</em><span class="optional">[</span>, <em>m</em><span class="optional">]</span><big>)</big> &rarr; [gmean float]<a class="headerlink" href="#functions.aggregate.statistics.gmean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes the genaralized mean (also known as the power mean or Holder mean),
which is an abstraction of the <em>Pythagorean means</em> including <em>arithmetic</em>, <em>geometric</em>, and <em>harmonic</em> means.</p>
<p>It is defined for a set of <em>n</em> positive real numbers as follows:</p>
<div class="math">
gmean_{\mathrm} =       \Big ( {1 \over N} \sum_{i=1}^{N} x_i ^p  \Big ) ^{1/p}</div>
<p>The (optional) second argument stands for the <em>p</em> paramteter, thus determining the exact mean type:</p>
<ul class="simple">
<li>p=2 : <em>Quadratic mean</em>     (computed for both negative and positive values)</li>
<li>p=1 : <em>Artihmetic mean</em></li>
<li>p=0 : <em>Geometric mean</em>     (only for positive real numbers)</li>
<li>p=-1: <em>Harmonian mean</em>     (only for positive real numbers)</li>
</ul>
<p>By default, i.e. in absence of second argument, p is set to 0, computing
the geometric mean.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">6</span>
<span class="gp">... </span><span class="s">50</span>
<span class="gp">... </span><span class="s">9</span>
<span class="gp">... </span><span class="s">1200</span>
<span class="gp">... </span><span class="s">&#39;text is ignored, as well as None values&#39;</span>
<span class="gp">... </span><span class="s">&#39;None&#39;</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select gmean(a) from table1&quot;</span><span class="p">)</span>
<span class="go">gmean(a)</span>
<span class="go">-------------</span>
<span class="go">42.4264068712</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table2</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">34</span>
<span class="gp">... </span><span class="s">27</span>
<span class="gp">... </span><span class="s">45</span>
<span class="gp">... </span><span class="s">55</span>
<span class="gp">... </span><span class="s">22</span>
<span class="gp">... </span><span class="s">34</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select gmean(a,1) from table2&quot;</span><span class="p">)</span>
<span class="go">gmean(a,1)</span>
<span class="go">-------------</span>
<span class="go">36.1666666667</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select gmean(a,0) from table2&quot;</span><span class="p">)</span>
<span class="go">gmean(a,0)</span>
<span class="go">-------------</span>
<span class="go">34.5451100372</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select gmean(a) from table2&quot;</span><span class="p">)</span>
<span class="go">gmean(a)</span>
<span class="go">-------------</span>
<span class="go">34.5451100372</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select gmean(a,-1) from table2&quot;</span><span class="p">)</span>
<span class="go">gmean(a,-1)</span>
<span class="go">-------------</span>
<span class="go">33.0179836512</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select gmean(a,2) from table2&quot;</span><span class="p">)</span>
<span class="go">gmean(a,2)</span>
<span class="go">-------------</span>
<span class="go">37.8043207407</span>
</pre></div>
</div>
</dd>
<dt><strong>median function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.statistics.median">
<tt class="descname">median</tt><big>(</big><em>X</em><big>)</big> &rarr; [median float]<a class="headerlink" href="#functions.aggregate.statistics.median" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns the median, i.e.numeric value separating the higher half of a sample, a population, or a probability distribution, from the lower half.
It is computed by arranging all the observations from lowest value to highest value and picking the middle one.
If there is an even number of observations, then there is no single middle value, so the mean of the two middle values is obtained.
Incoming textual values are simply ignored.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1</span>
<span class="gp">... </span><span class="s">3</span>
<span class="gp">... </span><span class="s">6</span>
<span class="gp">... </span><span class="s">6</span>
<span class="gp">... </span><span class="s">6</span>
<span class="gp">... </span><span class="s">6</span>
<span class="gp">... </span><span class="s">7</span>
<span class="gp">... </span><span class="s">7</span>
<span class="gp">... </span><span class="s">7</span>
<span class="gp">... </span><span class="s">7</span>
<span class="gp">... </span><span class="s">12</span>
<span class="gp">... </span><span class="s">12</span>
<span class="gp">... </span><span class="s">17</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select median(a) from table1&quot;</span><span class="p">)</span>
<span class="go">median(a)</span>
<span class="go">---------</span>
<span class="go">7.0</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table2</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1</span>
<span class="gp">... </span><span class="s">2</span>
<span class="gp">... </span><span class="s">2</span>
<span class="gp">... </span><span class="s">3</span>
<span class="gp">... </span><span class="s">3</span>
<span class="gp">... </span><span class="s">9</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select median(a) from table2&quot;</span><span class="p">)</span>
<span class="go">median(a)</span>
<span class="go">---------</span>
<span class="go">2.5</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table3</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1</span>
<span class="gp">... </span><span class="s">2</span>
<span class="gp">... </span><span class="s">maria</span>
<span class="gp">... </span><span class="s">lala</span>
<span class="gp">... </span><span class="s">null</span>
<span class="gp">... </span><span class="s">&#39;None&#39;</span>
<span class="gp">... </span><span class="s">3</span>
<span class="gp">... </span><span class="s">9</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select median(a) from table3&quot;</span><span class="p">)</span>
<span class="go">median(a)</span>
<span class="go">---------</span>
<span class="go">2.5</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="docutils">
<dt><strong>modeop function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.statistics.modeop">
<tt class="descname">modeop</tt><big>(</big><em>X</em><big>)</big> &rarr; [ModeOpElements int/str, ModeOpValue int]<a class="headerlink" href="#functions.aggregate.statistics.modeop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns the mode (i.e. the value that occurs the most frequently in a data set), along with the modevalue (i.e. the maximum frequency of occurrence)
When more than one modes are found in a data set (i.e. when more than one values appear with the maximum frequency), all values are returned.</p>
<p>For a sample from a continuous distribution, such as [0.935..., 1.211..., 2.430..., 3.668..., 3.874...], the concept of mode is unusable in its raw form,
since each value will occur precisely once. Following the usual practice, data is discretized by rounding to the closer int value.
For a textual sample, values are first converted to lowercase.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Returned multiset schema:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">Columns are automatically named as <em>ModeOpElements, ModeOpValue</em></td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="manual.html#tutmultiset"><em>Multisets</em></a> functions</li>
</ul>
</div>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1</span>
<span class="gp">... </span><span class="s">3</span>
<span class="gp">... </span><span class="s">6</span>
<span class="gp">... </span><span class="s">6</span>
<span class="gp">... </span><span class="s">6</span>
<span class="gp">... </span><span class="s">6</span>
<span class="gp">... </span><span class="s">7</span>
<span class="gp">... </span><span class="s">7</span>
<span class="gp">... </span><span class="s">7</span>
<span class="gp">... </span><span class="s">7</span>
<span class="gp">... </span><span class="s">12</span>
<span class="gp">... </span><span class="s">12</span>
<span class="gp">... </span><span class="s">17</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select modeop(a) from table1&quot;</span><span class="p">)</span>
<span class="go">ModeOpElements | ModeOpValue</span>
<span class="go">----------------------------</span>
<span class="go">6              | 4</span>
<span class="go">7              | 4</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table2</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1.1235</span>
<span class="gp">... </span><span class="s">1</span>
<span class="gp">... </span><span class="s">5.1</span>
<span class="gp">... </span><span class="s">5.2</span>
<span class="gp">... </span><span class="s">5.3</span>
<span class="gp">... </span><span class="s">5.5</span>
<span class="gp">... </span><span class="s">5.6</span>
<span class="gp">... </span><span class="s">5.7</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select modeop(a) from table2&quot;</span><span class="p">)</span>
<span class="go">ModeOpElements | ModeOpValue</span>
<span class="go">----------------------------</span>
<span class="go">5              | 3</span>
<span class="go">6              | 3</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table3</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">leuteris</span>
<span class="gp">... </span><span class="s">maria</span>
<span class="gp">... </span><span class="s">marialena</span>
<span class="gp">... </span><span class="s">Meili</span>
<span class="gp">... </span><span class="s">meili</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select modeop(a) from table3&quot;</span><span class="p">)</span>
<span class="go">ModeOpElements | ModeOpValue</span>
<span class="go">----------------------------</span>
<span class="go">meili          | 2</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="docutils">
<dt><strong>pearson function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.statistics.pearson">
<tt class="descname">pearson</tt><big>(</big><em>X</em>, <em>Y</em><big>)</big> &rarr; float<a class="headerlink" href="#functions.aggregate.statistics.pearson" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes the pearson coefficient of X and Y datasets</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select pearson(c1,1/c1) from range(1,91)&quot;</span><span class="p">)</span>
<span class="go">pearson(c1,1/c1)</span>
<span class="go">----------------</span>
<span class="go">-0.181568259801</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select pearson(c1,17*c1+5) from range(1,91)&quot;</span><span class="p">)</span>
<span class="go">pearson(c1,17*c1+5)</span>
<span class="go">-------------------</span>
<span class="go">1.0</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select pearson(c1,pyfun(&#39;math.pow&#39;,2,c1)) from range(1,41)&quot;</span><span class="p">)</span>
<span class="go">pearson(c1,pyfun(&#39;math.pow&#39;,2,c1))</span>
<span class="go">----------------------------------</span>
<span class="go">0.456349821382</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select pearson(a,b) from (select 1 as a, 2 as b)&quot;</span><span class="p">)</span>
<span class="go">pearson(a,b)</span>
<span class="go">------------</span>
<span class="go">0</span>
</pre></div>
</div>
</dd>
<dt><strong>rangef function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.statistics.rangef">
<tt class="descname">rangef</tt><big>(</big><em>X</em><big>)</big> &rarr; [rangef float]<a class="headerlink" href="#functions.aggregate.statistics.rangef" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes the numerical range for a dataset X, substracting the minimum value from the maximum value.
Textal and NULL data entries are simply ignored.</p>
<p>Examples:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1</span>
<span class="gp">... </span><span class="s">3</span>
<span class="gp">... </span><span class="s">6</span>
<span class="gp">... </span><span class="s">6</span>
<span class="gp">... </span><span class="s">7</span>
<span class="gp">... </span><span class="s">12</span>
<span class="gp">... </span><span class="s">12</span>
<span class="gp">... </span><span class="s">17</span>
<span class="gp">... </span><span class="s">&#39;text is ignored&#39;</span>
<span class="gp">... </span><span class="s">&#39;None&#39;</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select rangef(a) from table1&quot;</span><span class="p">)</span>
<span class="go">rangef(a)</span>
<span class="go">---------</span>
<span class="go">16.0</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="docutils">
<dt><strong>stdev function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.statistics.stdev">
<tt class="descname">stdev</tt><big>(</big><em>X</em><span class="optional">[</span>, <em>type</em><span class="optional">]</span><big>)</big> &rarr; [stdev float]<a class="headerlink" href="#functions.aggregate.statistics.stdev" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes standard deviation of a dataset X, i.e. the square root of its variance.
Sample standard deviation is determined by default; population standard deviation can be
determined by setting the (optional) second argument to values &#8216;true&#8217; or &#8216;population&#8217;.
When values &#8216;false&#8217; or &#8216;sample&#8217; are entered for type, the default sample standard deviation
computation is performed.</p>
<p>Examples:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">3</span>
<span class="gp">... </span><span class="s">7</span>
<span class="gp">... </span><span class="s">7</span>
<span class="gp">... </span><span class="s">19</span>
<span class="gp">... </span><span class="s">&#39;text is ignored&#39;</span>
<span class="gp">... </span><span class="s">&#39;none&#39;</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select stdev(a) from table1&quot;</span><span class="p">)</span>
<span class="go">stdev(a)</span>
<span class="go">-------------</span>
<span class="go">6.92820323028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select stdev(a,&#39;population&#39;) from table1&quot;</span><span class="p">)</span>
<span class="go">stdev(a,&#39;population&#39;)</span>
<span class="go">---------------------</span>
<span class="go">6.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select stdev(a,&#39;true&#39;) from table1&quot;</span><span class="p">)</span>
<span class="go">stdev(a,&#39;true&#39;)</span>
<span class="go">---------------</span>
<span class="go">6.0</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="docutils">
<dt><strong>variance function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.statistics.variance">
<tt class="descname">variance</tt><big>(</big><em>X</em><span class="optional">[</span>, <em>type</em><span class="optional">]</span><big>)</big> &rarr; [variance float]<a class="headerlink" href="#functions.aggregate.statistics.variance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Determine the measure of the spread of the data set about the mean.
Sample variance is determined by default; population variance can be
determined by setting the (optional) second argument to values &#8216;true&#8217; or &#8216;population&#8217;.
When values &#8216;false&#8217; or &#8216;sample&#8217; are entered for type, the default sample variance computation is performed.</p>
<p>Examples:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1</span>
<span class="gp">... </span><span class="s">2</span>
<span class="gp">... </span><span class="s">3</span>
<span class="gp">... </span><span class="s">4</span>
<span class="gp">... </span><span class="s">5</span>
<span class="gp">... </span><span class="s">6</span>
<span class="gp">... </span><span class="s">&#39;text is ignored&#39;</span>
<span class="gp">... </span><span class="s">&#39;none&#39;</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select variance(a) from table1&quot;</span><span class="p">)</span>
<span class="go">variance(a)</span>
<span class="go">-----------</span>
<span class="go">3.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select variance(a,&#39;false&#39;) from table1&quot;</span><span class="p">)</span>
<span class="go">variance(a,&#39;false&#39;)</span>
<span class="go">-------------------</span>
<span class="go">3.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select variance(a,&#39;sample&#39;) from table1&quot;</span><span class="p">)</span>
<span class="go">variance(a,&#39;sample&#39;)</span>
<span class="go">--------------------</span>
<span class="go">3.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select variance(a,&#39;True&#39;) from table1&quot;</span><span class="p">)</span>
<span class="go">variance(a,&#39;True&#39;)</span>
<span class="go">------------------</span>
<span class="go">2.91666666667</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select variance(a,&#39;Population&#39;) from table1&quot;</span><span class="p">)</span>
<span class="go">variance(a,&#39;Population&#39;)</span>
<span class="go">------------------------</span>
<span class="go">2.91666666667</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="docutils">
<dt><strong>wamean function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.statistics.wamean">
<tt class="descname">wamean</tt><big>(</big><em>W</em>, <em>X</em><big>)</big> &rarr; [wamean float]<a class="headerlink" href="#functions.aggregate.statistics.wamean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Computes the weighted arithmetic mean, i.e. the weighted average.
First column contains the weights and second column contains the actual data values.</p>
<div class="math">
wamean_{\mathrm} = \sum_{i=1}^{N} w_i x_i / \sum_{i=1}^{N} w_i</div>
<p>Examples:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">2 1</span>
<span class="gp">... </span><span class="s">2 2</span>
<span class="gp">... </span><span class="s">1 2</span>
<span class="gp">... </span><span class="s">&#39;text is ignored, as well as null values&#39; 3</span>
<span class="gp">... </span><span class="s">&#39;none&#39; 2</span>
<span class="gp">... </span><span class="s">1 &#39;text is ignored, as well as null values&#39;</span>
<span class="gp">... </span><span class="s">2 &#39;none&#39;</span>
<span class="gp">... </span><span class="s">2 3</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select wamean(a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">wamean(a,b)</span>
<span class="go">-----------</span>
<span class="go">2.0</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="module-functions.aggregate.subgroup">
<span id="subgroup-functions"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">subgroup</span></tt> functions<a class="headerlink" href="#module-functions.aggregate.subgroup" title="Permalink to this headline">¶</a></h2>
<p><strong>condbreak function</strong></p>
<blockquote>
<div><dl class="function">
<dt id="functions.aggregate.subgroup.condbreak">
<tt class="descname">condbreak</tt><big>(</big><em>groupid</em>, <em>C1</em>, <em>C2</em>, <em>....</em>, <em>condition</em>, <em>orderby</em><big>)</big> &rarr; [bgroupid,C1,C2....]<a class="headerlink" href="#functions.aggregate.subgroup.condbreak" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns an expanded <em>groupid</em> and the <em>value1...valueN</em>, perfoming new groupings when condition is true. Rows grouped together
are the ones that order by <em>orderby</em> column have no intermediate true values for <em>condition</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Returned multiset schema:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><ul class="first last">
<li><dl class="first docutils">
<dt><em>bgroupid</em></dt>
<dd><p class="first last"><em>groupid</em> appended with an integer value indicating the subgroup of the row.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>C1, C2 ..</em></dt>
<dd><p class="first last">The input values of the row.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="manual.html#tutmultiset"><em>Multisets</em></a> functions</li>
</ul>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1 user1  open</span>
<span class="gp">... </span><span class="s">2 user1  read</span>
<span class="gp">... </span><span class="s">3 user1  close</span>
<span class="gp">... </span><span class="s">4 user1  open</span>
<span class="gp">... </span><span class="s">5 user1  write</span>
<span class="gp">... </span><span class="s">6 user1  close</span>
<span class="gp">... </span><span class="s">7 user2  open</span>
<span class="gp">... </span><span class="s">8 user2  write</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select condbreak(b,c,c=&#39;open&#39;,a) from table1 group by b&quot;</span><span class="p">)</span>
<span class="go">bgroupid | C1</span>
<span class="go">----------------</span>
<span class="go">user11   | open</span>
<span class="go">user11   | read</span>
<span class="go">user11   | close</span>
<span class="go">user12   | open</span>
<span class="go">user12   | write</span>
<span class="go">user12   | close</span>
<span class="go">user21   | open</span>
<span class="go">user21   | write</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select condbreak(b,c,c=&#39;open&#39;,a) from (select 4 as a, 6 as b, 9 as c where c!=9)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>datediffbreak function</strong></p>
<blockquote>
<div><dl class="function">
<dt id="functions.aggregate.subgroup.datediffbreak">
<tt class="descname">datediffbreak</tt><big>(</big><em>groupid</em>, <em>C1</em>, <em>C2</em>, <em>....</em>, <em>date</em>, <em>maxdiff</em><span class="optional">[</span>, <em>'order'</em>, <em>orderbycol1</em>, <em>orderbycol2</em>, <em>...</em><span class="optional">]</span><big>)</big> &rarr; [bgroupid,C1,C2....]<a class="headerlink" href="#functions.aggregate.subgroup.datediffbreak" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns an expanded <em>groupid</em> and the <em>value1...valueN</em>, perfoming new groupings when subsequent rows <em>date</em> values differ more than <em>maxdiff</em> milliseconds. Rows grouped together
are the ones that order by <em>orderby</em> column or if ommited by the given order have less <em>date</em> distance than <em>maxdiff</em>. Input dates should be in <a class="reference internal" href="#iso8601"><em>ISO 8601 format</em></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Returned multiset schema:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><ul class="first last">
<li><dl class="first docutils">
<dt><em>bgroupid</em></dt>
<dd><p class="first last"><em>groupid</em> appended with an integer value indicating the subgroup of the row.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>C1, C2 ..</em></dt>
<dd><p class="first last">The input values of the row.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="manual.html#tutmultiset"><em>Multisets</em></a> functions</li>
</ul>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1 session1 &#39;2007-01-01 00:03:13&#39;</span>
<span class="gp">... </span><span class="s">2 session1 &#39;2007-01-01 00:03:27&#39;</span>
<span class="gp">... </span><span class="s">3 session1 &#39;2007-01-01 00:03:36&#39;</span>
<span class="gp">... </span><span class="s">4 session2 &#39;2007-01-01 00:04:39&#39;</span>
<span class="gp">... </span><span class="s">5 session2 &#39;2007-01-01 00:04:40&#39;</span>
<span class="gp">... </span><span class="s">6 session3 &#39;2007-01-01 00:04:49&#39;</span>
<span class="gp">... </span><span class="s">7 session3 &#39;2007-01-01 00:04:59&#39;</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select datediffbreak(b,a,c,10*1000,&#39;order&#39;,c,a) from table1 group by b&quot;</span><span class="p">)</span>
<span class="go">bgroupid  | C1</span>
<span class="go">--------------</span>
<span class="go">session10 | 1</span>
<span class="go">session11 | 2</span>
<span class="go">session11 | 3</span>
<span class="go">session20 | 4</span>
<span class="go">session20 | 5</span>
<span class="go">session30 | 6</span>
<span class="go">session30 | 7</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>datedifffilter function</strong></p>
<blockquote>
<div><dl class="function">
<dt id="functions.aggregate.subgroup.datedifffilter">
<tt class="descname">datedifffilter</tt><big>(</big><em>maxdiff</em>, <em>date</em>, <em>C1</em>, <em>C2 ....</em><big>)</big> &rarr; [date,C1,C2....]<a class="headerlink" href="#functions.aggregate.subgroup.datedifffilter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns only a subset of the provided entries, performing a sort of entry clustering based on the entries date difference. Each cluster is
represented by the latest entry.
The first argument defines the time differnece threshold that is employed for entry clustering, and it is provided in seconds.
The second argument is assumed to contain the date column. Entries are assumed to be provided in an ascending order by the date column.
Input dates should be in <a class="reference internal" href="#iso8601"><em>ISO 8601 format</em></a>.
All subsequent columns remain unchanged.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Returned multiset schema:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><ul class="first last">
<li><dl class="first docutils">
<dt><em>date, C1, C2 ..</em></dt>
<dd><p class="first last">The selected input values of the row.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="manual.html#tutmultiset"><em>Multisets</em></a> functions</li>
</ul>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">2010-01-01T01:32:03Z value1</span>
<span class="gp">... </span><span class="s">2010-01-01T01:32:04Z value2</span>
<span class="gp">... </span><span class="s">2010-01-01T01:32:06Z value3</span>
<span class="gp">... </span><span class="s">2010-01-01T01:32:08Z value4</span>
<span class="gp">... </span><span class="s">2010-01-01T01:32:29Z value5</span>
<span class="gp">... </span><span class="s">2010-01-01T02:35:03Z value6</span>
<span class="gp">... </span><span class="s">2010-01-01T02:35:04Z value7</span>
<span class="gp">... </span><span class="s">2010-01-01T03:55:04Z value8</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select datedifffilter(20, a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">date                 | C1</span>
<span class="go">-----------------------------</span>
<span class="go">2010-01-01T01:32:08Z | value4</span>
<span class="go">2010-01-01T01:32:29Z | value5</span>
<span class="go">2010-01-01T02:35:04Z | value7</span>
<span class="go">2010-01-01T03:55:04Z | value8</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">2010-01-01T01:32:03Z value1</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select datedifffilter(20, a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">date                 | C1</span>
<span class="go">-----------------------------</span>
<span class="go">2010-01-01T01:32:03Z | value1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">&#39;2010-01-01 01:32:03&#39; value1</span>
<span class="gp">... </span><span class="s">&#39;2010-01-01 01:32:04&#39; value2</span>
<span class="gp">... </span><span class="s">&#39;2010-01-01 01:32:06&#39; value3</span>
<span class="gp">... </span><span class="s">&#39;2010-01-01 01:32:08&#39; value4</span>
<span class="gp">... </span><span class="s">&#39;2010-01-01 01:32:29&#39; value5</span>
<span class="gp">... </span><span class="s">&#39;2010-01-01 02:35:03&#39; value6</span>
<span class="gp">... </span><span class="s">&#39;2010-01-01 02:35:04&#39; value7</span>
<span class="gp">... </span><span class="s">&#39;2010-01-01 03:55:04&#39; value8</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select datedifffilter(30, a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">date                | C1</span>
<span class="go">----------------------------</span>
<span class="go">2010-01-01 01:32:29 | value5</span>
<span class="go">2010-01-01 02:35:04 | value7</span>
<span class="go">2010-01-01 03:55:04 | value8</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>datediffgroup function</strong></p>
<blockquote>
<div><dl class="function">
<dt id="functions.aggregate.subgroup.datediffgroup">
<tt class="descname">datediffgroup</tt><big>(</big><em>maxdiff</em>, <em>date</em>, <em>C1</em>, <em>C2 ....</em><big>)</big> &rarr; [groupid, date,C1,C2....]<a class="headerlink" href="#functions.aggregate.subgroup.datediffgroup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Performing a sort of entry clustering based on the entries date difference.
The cluster id that is assigned to each entry is returned in the first column, and it is followed by the entry&#8217;s original contents.</p>
<p>The first argument defines the time differnece threshold that is employed for entry clustering, and it is provided in seconds.
The second argument is assumed to contain the date column. Entries are assumed to be provided in an ascending order by the date column.
Input dates should be in <a class="reference internal" href="#iso8601"><em>ISO 8601 format</em></a>.
All subsequent columns remain unchanged.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Returned multiset schema:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><ul class="first last">
<li><dl class="first docutils">
<dt><em>date, C1, C2 ..</em></dt>
<dd><p class="first last">The selected input values of the row.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="manual.html#tutmultiset"><em>Multisets</em></a> functions</li>
</ul>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">2010-01-01T01:32:03Z value1</span>
<span class="gp">... </span><span class="s">2010-01-01T01:32:04Z value2</span>
<span class="gp">... </span><span class="s">2010-01-01T01:32:06Z value3</span>
<span class="gp">... </span><span class="s">2010-01-01T01:32:08Z value4</span>
<span class="gp">... </span><span class="s">2010-01-01T01:32:29Z value5</span>
<span class="gp">... </span><span class="s">2010-01-01T02:35:03Z value6</span>
<span class="gp">... </span><span class="s">2010-01-01T02:35:04Z value7</span>
<span class="gp">... </span><span class="s">2010-01-01T03:55:04Z value8</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select datediffgroup(20,a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">groupid | date                 | C1</span>
<span class="go">---------------------------------------</span>
<span class="go">1       | 2010-01-01T01:32:03Z | value1</span>
<span class="go">1       | 2010-01-01T01:32:04Z | value2</span>
<span class="go">1       | 2010-01-01T01:32:06Z | value3</span>
<span class="go">1       | 2010-01-01T01:32:08Z | value4</span>
<span class="go">2       | 2010-01-01T01:32:29Z | value5</span>
<span class="go">3       | 2010-01-01T02:35:03Z | value6</span>
<span class="go">3       | 2010-01-01T02:35:04Z | value7</span>
<span class="go">4       | 2010-01-01T03:55:04Z | value8</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>datediffnewsesid function</strong></p>
<blockquote>
<div><dl class="function">
<dt id="functions.aggregate.subgroup.datediffnewsesid">
<tt class="descname">datediffnewsesid</tt><big>(</big><em>maxdiff</em>, <em>date</em>, <em>groupid</em>, <em>C1</em>, <em>C2</em>, <em>....</em><big>)</big> &rarr; [bgroupid, C1, C2, ...]<a class="headerlink" href="#functions.aggregate.subgroup.datediffnewsesid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Returns only the C1, C2, ... that should be updated with bgroupid, so as for the input groups to be effectively broken on maxdiff times.
Input dates should be in <a class="reference internal" href="#iso8601"><em>ISO 8601 format</em></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Returned multiset schema:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><ul class="first last">
<li><dl class="first docutils">
<dt><em>bgroupid</em></dt>
<dd><p class="first last"><em>groupid</em> appended with an integer value indicating the subgroup of the row.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>C1, C2 ..</em></dt>
<dd><p class="first last">The input values of the row.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1 session1 &#39;2007-01-01 00:03:13&#39;</span>
<span class="gp">... </span><span class="s">2 session1 &#39;2007-01-01 00:03:27&#39;</span>
<span class="gp">... </span><span class="s">3 session1 &#39;2007-01-01 00:03:36&#39;</span>
<span class="gp">... </span><span class="s">4 session2 &#39;2007-01-01 00:04:39&#39;</span>
<span class="gp">... </span><span class="s">5 session2 &#39;2007-01-01 00:05:40&#39;</span>
<span class="gp">... </span><span class="s">6 session3 &#39;2007-01-01 00:04:49&#39;</span>
<span class="gp">... </span><span class="s">7 session3 &#39;2007-01-01 00:06:59&#39;</span>
<span class="gp">... </span><span class="s">8 session3 &#39;2007-01-01 00:06:59&#39;</span>
<span class="gp">... </span><span class="s">9 session4 &#39;2007-01-01 00:04:59&#39;</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select datediffnewsesid(10, c, b, a) from table1 group by b&quot;</span><span class="p">)</span>
<span class="go">bgroupid  | C1</span>
<span class="go">--------------</span>
<span class="go">session11 | 2</span>
<span class="go">session11 | 3</span>
<span class="go">session21 | 5</span>
<span class="go">session31 | 7</span>
<span class="go">session31 | 8</span>
</pre></div>
</div>
</div></blockquote>
<dl class="docutils">
<dt><strong>groupmax function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.subgroup.groupmax">
<tt class="descname">groupmax</tt><big>(</big><em>n</em>, <em>col1</em>, <em>col2</em>, <em>col3</em>, <em>....</em><big>)</big><a class="headerlink" href="#functions.aggregate.subgroup.groupmax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>It groups by the first n columns of the input, and returns the maximum value of the rest.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Returned schema:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">Columns are automatically named as col1, col2 ...</td>
</tr>
</tbody>
</table>
<p>Examples:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">aa  t1 43</span>
<span class="gp">... </span><span class="s">ac  t2 34</span>
<span class="gp">... </span><span class="s">aa  t3 12</span>
<span class="gp">... </span><span class="s">ab  t4 21</span>
<span class="gp">... </span><span class="s">ac  t5 14</span>
<span class="gp">... </span><span class="s">as  t6 23</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select groupmax(1,a,b,c) from table1&quot;</span><span class="p">)</span>
<span class="go">c1 | c2 | c3</span>
<span class="go">------------</span>
<span class="go">ac | t5 | 34</span>
<span class="go">aa | t3 | 43</span>
<span class="go">ab | t4 | 21</span>
<span class="go">as | t6 | 23</span>
</pre></div>
</div>
</dd>
<dt><strong>groupsum function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.subgroup.groupsum">
<tt class="descname">groupsum</tt><big>(</big><em>n</em>, <em>col1</em>, <em>col2</em>, <em>col3</em>, <em>....</em><big>)</big><a class="headerlink" href="#functions.aggregate.subgroup.groupsum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>It groups by the first n columns of the input, and sums/jsets the rest.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Returned schema:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">Columns are automatically named as col1, col2 ...</td>
</tr>
</tbody>
</table>
<p>Examples:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">aa  t1 43</span>
<span class="gp">... </span><span class="s">ac  t2 34</span>
<span class="gp">... </span><span class="s">aa  t3 12</span>
<span class="gp">... </span><span class="s">ab  t4 21</span>
<span class="gp">... </span><span class="s">ac  t5 14</span>
<span class="gp">... </span><span class="s">as  t6 23</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select groupsum(1,a,b,c) from table1&quot;</span><span class="p">)</span>
<span class="go">c1 | c2          | c3</span>
<span class="go">---------------------</span>
<span class="go">ac | [&quot;t2&quot;,&quot;t5&quot;] | 48</span>
<span class="go">aa | [&quot;t1&quot;,&quot;t3&quot;] | 55</span>
<span class="go">ab | t4          | 21</span>
<span class="go">as | t6          | 23</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="module-functions.aggregate.text">
<span id="text-functions"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">text</span></tt> functions<a class="headerlink" href="#module-functions.aggregate.text" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><strong>concatgroup function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.text.concatgroup">
<tt class="descname">concatgroup</tt><big>(</big><em>X</em><big>)</big><a class="headerlink" href="#functions.aggregate.text.concatgroup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Concatenates strings in a group/dataset X.</p>
<p>Example:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">word1   1</span>
<span class="gp">... </span><span class="s">word2   1</span>
<span class="gp">... </span><span class="s">word3   2</span>
<span class="gp">... </span><span class="s">word4   2</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select concatgroup(a) from table1 group by b&quot;</span><span class="p">)</span>
<span class="go">concatgroup(a)</span>
<span class="go">--------------</span>
<span class="go">word1word2</span>
<span class="go">word3word4</span>
</pre></div>
</div>
</dd>
<dt><strong>concatlines function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.text.concatlines">
<tt class="descname">concatlines</tt><big>(</big><em>X</em><big>)</big><a class="headerlink" href="#functions.aggregate.text.concatlines" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Concatenates strings in a group/dataset X.</p>
<p>Example:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">word1</span>
<span class="gp">... </span><span class="s">word2</span>
<span class="gp">... </span><span class="s">word3</span>
<span class="gp">... </span><span class="s">word4</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select concatlines(a) from table1&quot;</span><span class="p">)</span>
<span class="go">concatlines(a)</span>
<span class="go">-----------------------</span>
<span class="go">word1</span>
<span class="go">word2</span>
<span class="go">word3</span>
<span class="go">word4</span>
</pre></div>
</div>
</dd>
<dt><strong>concatterms function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.text.concatterms">
<tt class="descname">concatterms</tt><big>(</big><em>text1</em>, <em>text2</em>, <em>...</em><big>)</big><a class="headerlink" href="#functions.aggregate.text.concatterms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Concatenates strings in a group/dataset X, while keeping them disjoint, i.e. using the single space delimiter.</p>
<p>Examples:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">word1   1</span>
<span class="gp">... </span><span class="s">word2   1</span>
<span class="gp">... </span><span class="s">word3   2</span>
<span class="gp">... </span><span class="s">word4   2</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select concatterms(a) from table1 group by b&quot;</span><span class="p">)</span>
<span class="go">concatterms(a)</span>
<span class="go">--------------</span>
<span class="go">word1 word2</span>
<span class="go">word3 word4</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="module-functions.aggregate.util">
<span id="util-functions"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">util</span></tt> functions<a class="headerlink" href="#module-functions.aggregate.util" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><strong>expandgroups function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.util.expandgroups">
<tt class="descname">expandgroups</tt><big>(</big><em>args</em><big>)</big> &rarr; args<a class="headerlink" href="#functions.aggregate.util.expandgroups" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Expands the contents of groups. Usefull for debugging group related queries.</p>
<p>Examples:</p>
<p>Directed graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1   2</span>
<span class="gp">... </span><span class="s">2   3</span>
<span class="gp">... </span><span class="s">1   4</span>
<span class="gp">... </span><span class="s">2   5</span>
<span class="gp">... </span><span class="s">3   3</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select expandgroups(a,b) from table1&quot;</span><span class="p">)</span>
<span class="go">C1 | C2</span>
<span class="go">-------</span>
<span class="go">1  | 2</span>
<span class="go">2  | 3</span>
<span class="go">1  | 4</span>
<span class="go">2  | 5</span>
<span class="go">3  | 3</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select expandgroups(a,b) as gr from table1&quot;</span><span class="p">)</span>
<span class="go">gr1 | gr2</span>
<span class="go">---------</span>
<span class="go">1   | 2</span>
<span class="go">2   | 3</span>
<span class="go">1   | 4</span>
<span class="go">2   | 5</span>
<span class="go">3   | 3</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select a,expandgroups(b) as gr from table1 group by a&quot;</span><span class="p">)</span>
<span class="go">a | gr</span>
<span class="go">------</span>
<span class="go">1 | 2</span>
<span class="go">1 | 4</span>
<span class="go">2 | 3</span>
<span class="go">2 | 5</span>
<span class="go">3 | 3</span>
</pre></div>
</div>
</dd>
<dt><strong>showgroups function</strong></dt>
<dd><dl class="first function">
<dt id="functions.aggregate.util.showgroups">
<tt class="descname">showgroups</tt><big>(</big><em>args</em><big>)</big> &rarr; string<a class="headerlink" href="#functions.aggregate.util.showgroups" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Shows the contents of groups. Usefull for debugging group related queries.</p>
<p>Examples:</p>
<p>Directed graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">table1</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s">1   2</span>
<span class="gp">... </span><span class="s">2   3</span>
<span class="gp">... </span><span class="s">1   4</span>
<span class="gp">... </span><span class="s">2   5</span>
<span class="gp">... </span><span class="s">3   3</span>
<span class="gp">... </span><span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select showgroups(a,b) from table1&quot;</span><span class="p">)</span> 
<span class="go">showgroups(a,b)</span>
<span class="go">--------------------</span>

<span class="go">1        2</span>
<span class="go">2        3</span>
<span class="go">1        4</span>
<span class="go">2        5</span>
<span class="go">3        3</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span><span class="p">(</span><span class="s">&quot;select showgroups(b) as gr from table1 group by a&quot;</span><span class="p">)</span>
<span class="go">gr</span>
<span class="go">----</span>

<span class="go">2</span>
<span class="go">4</span>

<span class="go">3</span>
<span class="go">5</span>

<span class="go">3</span>
</pre></div>
</div>
</dd>
</dl>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/madislog.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Aggregate functions list</a><ul>
<li><a class="reference internal" href="#module-functions.aggregate.date"><tt class="docutils literal"><span class="pre">date</span></tt> functions</a></li>
<li><a class="reference internal" href="#module-functions.aggregate.graph"><tt class="docutils literal"><span class="pre">graph</span></tt> functions</a></li>
<li><a class="reference internal" href="#module-functions.aggregate.jpacks"><tt class="docutils literal"><span class="pre">jpacks</span></tt> functions</a></li>
<li><a class="reference internal" href="#module-functions.aggregate.mining"><tt class="docutils literal"><span class="pre">mining</span></tt> functions</a></li>
<li><a class="reference internal" href="#module-functions.aggregate.partialsort"><tt class="docutils literal"><span class="pre">partialsort</span></tt> functions</a></li>
<li><a class="reference internal" href="#module-functions.aggregate.selection"><tt class="docutils literal"><span class="pre">selection</span></tt> functions</a></li>
<li><a class="reference internal" href="#module-functions.aggregate.statistics"><tt class="docutils literal"><span class="pre">statistics</span></tt> functions</a></li>
<li><a class="reference internal" href="#module-functions.aggregate.subgroup"><tt class="docutils literal"><span class="pre">subgroup</span></tt> functions</a></li>
<li><a class="reference internal" href="#module-functions.aggregate.text"><tt class="docutils literal"><span class="pre">text</span></tt> functions</a></li>
<li><a class="reference internal" href="#module-functions.aggregate.util"><tt class="docutils literal"><span class="pre">util</span></tt> functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="row.html"
                        title="previous chapter">Row functions list</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="vtable.html"
                        title="next chapter">Vtable functions list</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/aggregate.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="vtable.html" title="Vtable functions list"
             >next</a> |</li>
        <li class="right" >
          <a href="row.html" title="Row functions list"
             >previous</a> |</li>
        <li><a href="index.html">madIS 1.9 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2010, L. Stamatogiannakis, M. Triantafyllidi, M. Vayanou, M. Kyriakidi.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>